PORT=3000
DB_HOST=127.0.0.1
DB_PORT=3306
DB_USER=root
DB_PASSWORD=123456
DB_NAME=test_db

# 允许前端域名，逗号分隔。* 表示放开（开发阶段）
CORS_ORIGINS=*

# CSP 配置（逗号分隔，'self' 需保留引号）
CSP_ENABLED=true
CSP_IMG_SRC='self',data:,https://wb.254253.xyz,https://tvax4.sinaimg.cn
CSP_CONNECT_SRC='self'
CSP_SCRIPT_SRC='self'

# HTTP 非 localhost 环境下如需消除 COOP 提示可关闭
COOP_ENABLED=true

# 是否启用 JWT 鉴权
REQUIRE_AUTH=true

# JWT 配置
JWT_SECRET=replace-with-a-long-random-secret
JWT_EXPIRES_IN=8h

# 认证来源: env 或 db
AUTH_PROVIDER=db

# 用户表名（AUTH_PROVIDER=db 时生效）
AUTH_USER_TABLE=gateway_users

# 密码哈希成本（bcrypt）
BCRYPT_ROUNDS=12

# 账号配置（AUTH_PROVIDER=env 时生效）
# 格式：username:password_hash_or_plain:role
AUTH_USERS=admin:$2b$12$replace_me:admin;analyst:$2b$12$replace_me:analyst

# 按角色限制可访问表，格式：role:table1|table2;admin:* 表示 admin 可访问所有表
ROLE_TABLES=admin:*;analyst:users|orders

# 允许操作的 SQL 类型，逗号分隔：select,insert,update,delete
ALLOWED_SQL_TYPES=select,insert,update,delete

# 允许操作的表名，逗号分隔。留空表示不限制（不建议）
ALLOWED_TABLES=users,orders,products

# 是否要求 SELECT 必须带 LIMIT
REQUIRE_SELECT_LIMIT=true

# SELECT 最大 LIMIT
MAX_SELECT_LIMIT=500

# 限流配置（/api/sql）
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX=60

# 审计日志查询最大条数（/admin/audit-logs）
AUDIT_QUERY_MAX_LIMIT=500

# 用户列表查询最大条数（/admin/users）
ADMIN_USER_QUERY_MAX_LIMIT=200

# 审计日志文件
AUDIT_LOG_FILE=./logs/audit.log

# 是否由网关托管前端（Vue dist）
FRONTEND_ENABLED=true

# 前端打包目录（包含 index.html）
FRONTEND_DIST_DIR=./frontend-app/dist

# HTTPS 配置（内网建议开启；需把根证书信任到访问终端）
HTTPS_ENABLED=false
HTTPS_CERT_PATH=./certs/server.pem
HTTPS_KEY_PATH=./certs/server-key.pem

# 请求参数加密（AES-256-GCM）
REQUEST_ENCRYPTION_ENABLED=false
REQUEST_ENCRYPTION_ALLOW_PLAINTEXT=true
REQUEST_ENCRYPTION_PASSWORD=replace-with-shared-password

# 多项目网关默认上下文（兼容 /api/sql）
DEFAULT_PROJECT_KEY=default
DEFAULT_PROJECT_ENV=prod

# 平台配置中心（项目/环境/变量）
PROJECT_CONFIG_CACHE_TTL_MS=15000
CONFIG_ENCRYPTION_KEY=replace-with-32-char-random-secret
PLATFORM_PROJECT_TABLE=gateway_projects
PLATFORM_PROJECT_ENV_TABLE=gateway_project_envs
PLATFORM_ENV_VAR_TABLE=gateway_project_env_vars

# 创建项目时自动初始化一个默认环境
PLATFORM_AUTO_CREATE_DEFAULT_ENV=true
PLATFORM_DEFAULT_ENV_KEY=prod
PLATFORM_DEFAULT_ENV_STATUS=active
PLATFORM_DEFAULT_DB_HOST=127.0.0.1
PLATFORM_DEFAULT_DB_PORT=3306
PLATFORM_DEFAULT_DB_USER=root
PLATFORM_DEFAULT_DB_PASSWORD=123456
PLATFORM_DEFAULT_DB_NAME_TEMPLATE={projectKey}_{env}

# 是否在创建项目时自动执行 CREATE DATABASE IF NOT EXISTS
PLATFORM_AUTO_CREATE_DATABASE=true
PLATFORM_DEFAULT_DB_CHARSET=utf8mb4
PLATFORM_DEFAULT_DB_COLLATE=utf8mb4_unicode_ci
PLATFORM_AUTO_INIT_TABLES=true
PLATFORM_DEFAULT_INIT_TABLES=users,orders,products

# Nginx 配置管理（项目创建时自动生成 conf，后台可编辑并重载）
NGINX_CONFIG_ENABLED=true
NGINX_AUTO_GENERATE_ON_PROJECT_CREATE=true
NGINX_AUTO_CREATE_FRONTEND_DIR=true
NGINX_CONF_DIR=./runtime/nginx/conf.d
NGINX_CONF_FILENAME_TEMPLATE={projectKey}_{env}.conf
NGINX_SERVER_NAME_TEMPLATE={projectKey}.local
NGINX_LISTEN_PORT=80
NGINX_FRONTEND_ROOT=/usr/share/nginx/html
NGINX_PROJECT_FRONTEND_DIR_TEMPLATE=./runtime/project-web/{projectKey}/{env}/current
NGINX_PROJECT_FRONTEND_WEB_ROOT_TEMPLATE=/project-web/{projectKey}/{env}/current
NGINX_UPSTREAM_ORIGIN=http://gateway:3000
# 若后端跑在宿主机并管理 docker 容器，可设置为：docker exec easydb-nginx nginx -s reload
NGINX_RELOAD_COMMAND=

# 初始化用户（npm run auth:init 时使用，可选）
SEED_ADMIN_USERNAME=admin
SEED_ADMIN_PASSWORD=admin123
SEED_ANALYST_USERNAME=analyst
SEED_ANALYST_PASSWORD=analyst123
