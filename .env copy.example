PORT=3003
DB_HOST=192.168.1.125
DB_PORT=3306
DB_USER=root
DB_PASSWORD=Krystal1024.
DB_NAME=weibo

# 允许前端域名，逗号分隔。* 表示放开（开发阶段）
CORS_ORIGINS=*

# CSP 配置（逗号分隔，'self' 需保留引号）
CSP_ENABLED=true
CSP_IMG_SRC='self',data:,https://wb.254253.xyz,https://tvax4.sinaimg.cn
CSP_CONNECT_SRC='self'
CSP_SCRIPT_SRC='self'

# HTTP 非 localhost 环境下如需消除 COOP 提示可关闭
COOP_ENABLED=true

# 是否启用 JWT 鉴权
REQUIRE_AUTH=true

# JWT 配置
JWT_SECRET=replace-with-a-long-random-secret
JWT_EXPIRES_IN=8h

# 认证来源: env 或 db
AUTH_PROVIDER=db

# 用户表名（AUTH_PROVIDER=db 时生效）
AUTH_USER_TABLE=gateway_users

# 密码哈希成本（bcrypt）
BCRYPT_ROUNDS=12

# 账号配置，格式：username:password_hash_or_plain:role
# 推荐使用 bcrypt 哈希，生成方式：npm run hash:password -- yourPassword
AUTH_USERS=admin:$2b$12$mLx1iKiVhFY8vgs.uuV.JeU0QhF9yRDu6cMA1tlutj7u/TWz4HRwO:admin;analyst:$2b$12$q1pEp4/o6svhpA.Rse.tAeUKVmk40YjYQoL5FhwPNARAdSXVUO/ci:analyst

# 按角色限制可访问表，格式：role:table1|table2;admin:* 表示 admin 可访问所有表
ROLE_TABLES=admin:*;analyst:users|orders

# 允许操作的 SQL 类型，逗号分隔：select,insert,update,delete
ALLOWED_SQL_TYPES=select,insert,update,delete

# 允许操作的表名，逗号分隔。留空表示不限制（不建议）
ALLOWED_TABLES=users,orders,products

# 是否要求 SELECT 必须带 LIMIT
REQUIRE_SELECT_LIMIT=true

# SELECT 最大 LIMIT
MAX_SELECT_LIMIT=500

# 限流配置（/api/sql）
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX=60

# 审计日志查询最大条数（/admin/audit-logs）
AUDIT_QUERY_MAX_LIMIT=500

# 用户列表查询最大条数（/admin/users）
ADMIN_USER_QUERY_MAX_LIMIT=200

# 审计日志文件
AUDIT_LOG_FILE=./logs/audit.log

# 是否由网关托管前端（Vue dist）
FRONTEND_ENABLED=true

# Vue 打包目录（包含 index.html）
FRONTEND_DIST_DIR=./frontend-dist

# HTTPS 配置（内网建议开启；需把根证书信任到访问终端）
HTTPS_ENABLED=false
HTTPS_CERT_PATH=./certs/server.pem
HTTPS_KEY_PATH=./certs/server-key.pem

# 请求参数加密（AES-256-GCM）
REQUEST_ENCRYPTION_ENABLED=true
REQUEST_ENCRYPTION_ALLOW_PLAINTEXT=true
REQUEST_ENCRYPTION_PASSWORD=replace-with-shared-password

# 初始化用户（npm run auth:init 时使用，可选）
SEED_ADMIN_USERNAME=admin
SEED_ADMIN_PASSWORD=admin123
SEED_ANALYST_USERNAME=analyst
SEED_ANALYST_PASSWORD=analyst123
